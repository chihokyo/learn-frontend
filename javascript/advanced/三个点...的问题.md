# ä¸‰ä¸ªç‚¹...

è¿™ä¸ªåœ¨ ES6 ä¹‹åŽæˆ‘è¡¨ç¤ºå¾ˆç³Šæ¶‚ã€‚è™½ç„¶æ¯æ¬¡çœ‹éƒ½æ‡‚ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¼šè¿·ç³Šã€‚

è‡ªå·±å°±å…ˆæ•´ç†ä¸€ä¸‹å§ã€‚

> é¦–å…ˆéƒ½æ˜¯...ä¸‰ä¸ªç‚¹ï¼Œä½†æ˜¯åœ¨ä¸åŒçš„åœºåˆæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚
>
> å…¶æ¬¡ï¼Œå¿…é¡»è¦å†™ä¸ªå‡ åéä½ æ‰ä¼šè®°å¾—ä½ã€‚ã€‚ðŸ¤•

## 1 å±•å¼€è¯­æ³• Spread Syntax

**é¦–å…ˆå¥¹å’Œå‰©ä½™å‚æ•°å®Œå…¨ä¸æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼**

å‚è€ƒé“¾æŽ¥ï¼š[å‰©ä½™è¯­æ³•ï¼ˆå‰©ä½™å‚æ•°ï¼‰](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_syntax#å‰©ä½™è¯­æ³•ï¼ˆå‰©ä½™å‚æ•°ï¼‰)

å±•å¼€è¯­æ³•çš„æœ¬è´¨æ˜¯ä¸€ä¸ª**æµ…æ‹·è´**ã€‚

é¦–å…ˆå±•å¼€è¯­æ³•ä¸æ˜¯ä»€ä¹ˆæ—¶å€™éƒ½å¯ä»¥ç”¨åˆ°çš„ã€‚ä¸»è¦ç”¨äºŽä¸‹é¢å‡ ä¸ªåœºæ™¯ã€‚

```javascript
// 1.å‡½æ•°è°ƒç”¨çš„æ—¶å€™ ä¸ºäº†åˆ†åˆ«ä¼ å…¥å‚æ•°
const arr = ['foo', 'bar', 'baz'];
const str = 'chin';
function foo(x, y, z) {
  console.log(x, y, z);
}
// å¦‚æžœä¸ºäº†è¾¾åˆ°åœ¨è°ƒç”¨fooå‡½æ•°é¡ºä¾¿æŠŠarrå½“åšå‚æ•°ä¼ è¿›åŽ»ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•
// ä½¿ç”¨applyçš„ç›®çš„ä¸æ˜¯ä¸ºäº†è°ƒç”¨å‡½æ•°ï¼Œè€Œæ˜¯ä¸ºäº†æ”¹å˜thisçš„æŒ‡å‘ã€‚
foo.apply(null, arr);
// åœ¨è°ƒç”¨å‡½æ•°ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦
foo(...arr);
foo(...str); // è¿˜å¯ä»¥å±•å¼€å­—ç¬¦ä¸² c h i

// 2.æž„é€ æ•°ç»„
const arr = ['yes', 'abc', 'xyz'];
const newArr = [...arr, 'yes'];
console.log(newArr); // [ 'yes', 'abc', 'xyz', 'yes' ]

const str = 'my'; // ç”šè‡³å¯ä»¥æ‹†åˆ†å­—ç¬¦ä¸²ä¸ºæ•°ç»„
console.log([...arr, ...str]); // [ 'yes', 'abc', 'xyz', 'm', 'y' ]

// 3.ES9ä¹‹åŽ
const info = {
  id: 'uuid',
  age: 19,
};
// 3-1 æž„é€ æ–°å¯¹è±¡å­—é¢é‡
const newInfo = { ...info, location: 'Tokyo' }; // é‡åçš„è¯ï¼Œå°±æ˜¯è¦†ç›–ï¼ï¼ï¼
const arr = ['yes', 'abc', 'xyz'];
console.log(newInfo);
// 3-2 ç”šè‡³å¯ä»¥æˆä¸ºæ•°ç»„ï¼ˆä¼šæ·»åŠ ç´¢å¼•å€¼ï¼‰
const newInfo2 = { ...info, ...arr };
console.log(newInfo2); // { '0': 'yes', '1': 'abc', '2': 'xyz', id: 'uuid', age: 19 }
```

> å°¤å…¶è¦å¤šçœ‹ ES9 ä¹‹åŽä¹‹åŽçš„æž„å»ºæ–°çš„å­—é¢é‡ï¼Œå› ä¸º React æ“ä½œæ•°æ®çš„æ—¶å€™ç»å¸¸ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚

æ¯”å¦‚ä¸‹é¢çš„è®¾ç½®ä¸€ä¸ªæ–°çš„å€¼

```jsx
// æˆ‘æƒ³äº†ä¸€ä¸‹å…³äºŽä¸ºä»€ä¹ˆæˆ‘ä¿®æ”¹stateInfoå®žåœ¨èŠ±äº†å¾ˆä¹…çš„é—®é¢˜
const [stateData, setStateData] = useState({
  stateId: 'stateId',
  stateInfo: ['stateSwim', 'stateSleep'],
});

// å¢žåŠ 
const handleInfo = () => {
  // æœ¬è´¨å°±æ˜¯é‡æ–°å¤åˆ¶ä¸€ä»½å…ƒæ•°æ®ï¼Œç‹¬ç„¶åŽå®Œå…¨è¦†ç›–å°±è¡Œ

  // å†™æ³•1ï¸âƒ£ åªæ˜¯å¤åˆ¶æ•°ç»„
  // const stateInfo = [...stateData.stateInfo, 'eat'];
  // setStateData({ ...stateData, stateInfo });

  // å†™æ³•2ï¸âƒ£ å…¨éƒ¨å®Œå…¨å¤åˆ¶ä¸€ä»½ç›´æŽ¥è¦†ç›–
  // const newStateData = { ...stateData };
  // newStateData.stateInfo.push('eat'); // ç›¸å½“äºŽæ”¹å˜äº†newStateDataæ•°æ®æœ¬èº«äº†
  // setStateData({ ...stateData, newStateData });

  // å†™æ³•3ï¸âƒ£ åŒé‡è§£æž„ï¼ˆES9ä¹‹åŽçš„æž„å»ºæ–°å­—é¢é‡ï¼‰
  setStateData({ ...stateData, stateInfo: [...stateData.stateInfo, 'eat'] });
};
```

ä¸ºä»€ä¹ˆè¯´å±•å¼€è¿ç®—ç¬¦æœ¬è´¨æ˜¯ä¸€ä¸ªæµ…æ‹·è´å‘¢ï¼Ÿ

```javascript
const info = {
  id: 'uu1',
  hobby: ['swim', 'run'],
};

const newInfo = { ...info };
newInfo.hobby[0] = ['sleep'];
console.log(newInfo); // { id: 'uu1', hobby: [ [ 'sleep' ], 'run' ] }
console.log(info); // { id: 'uu1', hobby: [ [ 'sleep' ], 'run' ] }
```

è¿™é‡Œè¯´ä¸€äº›ç»“è®º

å½“ä½ æƒ³ç®€å•æ‹·è´ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œç›´æŽ¥å¯ä»¥

```javascript
const obj = {
  id: 'uu1',
  hobby: ['swim', 'run'],
};
const newObj = { ...obj };
```

## 2 è§£æž„èµ‹å€¼ Destructuring Assignment

è¿™ä¸ªç®—ä½œå±•å¼€è¿ç®—ç¬¦ã€‚

### æ•°ç»„è§£æž„

```js
// ********â‘  åŸºç¡€è§£æž„********
var arr = ['chin', 'foo', 'bar'];
console.log(arr[0]); // chin
console.log(arr[1]); // foo
console.log(arr[2]); // bar
// è¿™é‡Œç›¸å½“äºŽä»Ž
var [one, two, three] = arr;
// â†“
var arr = ['chin', 'foo', 'bar'];
var one = arr[0],
  two = arr[1],
  three = arr[2];

// â‘¡ ********è§£æž„åŽé¢çš„********
var arr = ['chin', 'foo', 'bar'];
var [, , item] = arr;
console.log(item); // bar

// â‘¢ ********è§£æž„å‡ºä¸€ä¸ªå…ƒç´ ,åŽé¢çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æ•°ç»„ä¸­********
var arr = ['chin', 'foo', 'bar'];
var [itemx, ...itemy] = arr;
console.log(itemy); // [ 'foo', 'bar' ]

//  â‘£ ********ç»™ä¸ªé»˜è®¤å€¼********
var arr = ['chin', 'foo', 'bar'];
var [itema, itemb, itemc, itemd] = arr;
console.log(itemd); // undefined
var [itema, itemb, itemc, itemd = 'yes'] = arr;
console.log(itemd); // yes
```

> å…¶å®ž react é‡Œé¢çš„ â†“
>
> `const [number, setNumber] = useState(0)` å…¶å®žè¿™ä¸ªæœ¬è´¨ä¹Ÿæ˜¯æ•°ç»„çš„è§£æž„èµ‹å€¼ã€‚

```js
const arr = useState(0);
const number = arr[0];
const setNumber = arr[1];
```

### å¯¹è±¡è§£æž„

å…¶å®žè¿™ä¸ªæ¯”è¾ƒå¸¸ç”¨ï¼Œæ¯”èµ·æ•°ç»„æ¥è¯´ã€‚

React ç»å¸¸ç”¨è¿™ä¸ªæ–¹å¼ï¼Œåœ¨ä¼ é€’å‚æ•°çš„æ—¶å€™ã€‚

`function ({option})` â†’ å·®ä¸å°±è¿™ç§ç»å¸¸ç”¨ã€‚å…¶å®žå°±æ˜¯æŠŠ props ç»™è§£æž„äº†ã€‚

```js
// ********â‘  åŸºç¡€è§£æž„********
var obj = {
  id: 'uu1',
  age: 99,
  hobby: ['swim', 'movie'],
};

var { id, age, hobby } = obj;
console.log(id); // uu1
console.log(age); // 99
console.log(hobby); // ['swim', 'movie']

// ********â‘¡ é‡å‘½å********
var obj = {
  id: 'uu1',
  age: 99,
  hobby: ['swim', 'movie'],
};
var { id: uuid } = obj;
console.log(uuid); // uu1

// ********â‘¢ é»˜è®¤å€¼********
var obj = {
  id: 'uu1',
  age: 99,
  hobby: ['swim', 'movie'],
};
var { location: newLocation = 'china' } = obj;
console.log(newLocation);

// ********â‘£ åœ¨å‡½æ•°é‡Œä¸€ç›´è¿™æ ·ç”¨ï¼Œåœ¨å‚æ•°é‡Œç›´æŽ¥è§£æž„äº†********
var obj = {
  id: 'uu1',
  age: 99,
  hobby: ['swim', 'movie'],
};
function foo({ id }) {
  console.log(id);
}

foo(obj);
```

## 3 å‰©ä½™å‚æ•° Rest Parameter

é¦–å…ˆè¿™ä¸ª`...`ä¸æ˜¯å±•å¼€è¿ç®—ç¬¦ï¼Œåªæ˜¯ä¸ª**å‰ç¼€**ã€‚

ç›¸å½“äºŽæŠŠå‰©ä½™çš„å‚æ•°æ”¾å…¥`args`è¿™ä¸ªå˜é‡é‡Œï¼Œæˆä¸ºæ•°ç»„ã€‚

âš ï¸ è€Œä¸”å¿…é¡»æ”¾åœ¨æœ€åŽã€‚âš ï¸ å¿…é¡»æ”¾åœ¨å‡½æ•°å®šä¹‰å‚æ•°åœ°æ–¹

`demo(...args)` ç»å¸¸çœ‹åˆ°çš„è¿™ç§ä¸æ˜¯å‰©ä½™å‚æ•°ï¼Œè€Œæ˜¯å±•å¼€è¯­æ³•ã€‚å› ä¸ºè¿™æ˜¯**å‡½æ•°è°ƒç”¨**ï¼Œè€Œä¸æ˜¯**å‡½æ•°å®šä¹‰**ã€‚

è¿™ä¸ªæ˜¯ä¸ºäº†ä»£æ›¿*arguments*ä¹‹åŽå‡ºçŽ°çš„

```javascript
function foo(x, y, ...args) {
  console.log(args);
}
foo(10, 20, 30, 40); // [ 30, 40 ]

function foo(...args) {
  console.log(args);
}
foo(10, 20, 30, 40); // [ 10, 20, 30, 40 ]
```

![image-20220603171539501](https://raw.githubusercontent.com/chihokyo/image_host/develop/image-20220603171539501.png)

> arguments åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
>
> - æ˜¯ç±»æ•°ç»„çš„å¯¹è±¡ï¼ˆä¼ªæ•°ç»„ï¼‰ï¼Œå‰©ä½™å‚æ•°æ˜¯çœŸæ•°ç»„ã€‚å¯ä»¥æœ‰æ¯”å¦‚ `sort`ï¼Œ`map`ï¼Œ`forEach`æˆ–`pop` è¿™æ ·çš„æ–¹æ³•
> - arguments åŒ…å«æ‰€æœ‰å‚æ•°ï¼Œè€Œå‰©ä½™å‚æ•°åªæœ‰å‰©ä½™å‚æ•°ã€‚`arguments`å¯¹è±¡è¿˜æœ‰ä¸€äº›é™„åŠ çš„å±žæ€§ ï¼ˆå¦‚`callee`å±žæ€§ï¼‰ã€‚

## è‡ªæˆ‘æµ‹è¯•å‘ æœ€åŽçš„æ€è€ƒé¢˜

æ‰‹å†™ call/apply/bindï¼Œå¦‚æžœä¸‹é¢çš„ 4 ä¸ªé—®å·éƒ½èƒ½ç†è§£ã€‚å·®ä¸å¤šã€‚ä½ å°±ç†è§£äº†ä¸‰ä¸ªç‚¹çš„é—®é¢˜ã€‚

```js
// call
Function.prototype.mycall = function (thisArg, ...restParams) {
  // ðŸ¤” è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
  fn = this;
  thisArg.fn = fn;
  // ðŸ¤” è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
  const result = thisArg.fn(...restParams);
  delete thisArg.fn;
  return result;
};
// apply
Function.prototype.myApply = function (thisArgs, arrParam) {
  fn = this;
  thisArgs =
    thisArgs !== null && thisArgs !== undefined ? Object(thisArgs) : window;

  thisArgs.fn = fn;
  // ðŸ¤” è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
  const result = thisArgs.fn(...arrParam);
  delete thisArgs.fn;
  return result;
};
// bind
Function.prototype.myBind = function (thisArg, ...restParams) {
  fn = this;
  thisArgs =
    thisArgs !== null && thisArgs !== undefined ? Object(thisArgs) : window;
  thisArg.fn = fn;
  function proxyFn(...proxyRestParam) {
    // ðŸ¤” è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
    const finalParams = [...restParams, ...proxyRestParam];
    const result = thisArg.fn(finalParams);
    delete thisArg.fn;
    return result;
  }
  return proxyFn;
};
```

- è£… ï¼ˆå‰©ä½™å‚æ•° åœ¨å‡½æ•°å®šä¹‰
- æ‹† ï¼ˆå±•å¼€è¯­æ³• åœ¨å‡½æ•°è°ƒç”¨
- ç›´æŽ¥æ˜¯æ•°ç»„ï¼Œå› ä¸ºæ˜¯ apply
- åˆå¹¶æ•°ç»„

é¡ºä¾¿åœ¨å¢žåŠ ä¸€ä¸ªï¼Œå°±æ˜¯åˆ©ç”¨ reduce å®žçŽ°ä¸€ä¸ª compose å‡½æ•°çš„é—®é¢˜

```js
const double = (x) => x + x;
const triple = (x) => 3 * x;
const quadruple = (x) => 4 * x;

const compose = function (...fns) {
  return function (initValue) {
    return fns.reduce((acc, fn) => {
      return fn(acc);
    }, initValue);
  };
};

const multiply24 = compose(double, triple, quadruple);
console.log(multiply24(10));
// å¼€å§‹è§£æž
// è¿™ä¸ª ...fns å…¶å®žå°±æ˜¯æŠŠå‡½æ•°éƒ½è£…è¿›åŽ»äº†fnsè¿™ä¸ªæ•°ç»„é‡Œé¢
// è¿™ä¹Ÿç®—ã€å‰©ä½™å‚æ•°ã€‘åº”ç”¨
const compose = function ([double, triple, quadruple]) {
  return function (initValue) {
    return [double, triple, quadruple].reduce((acc, fn) => {
      return fn(acc);
    }, initValue);
  };
};
```
